{
  "id": "webhook_1771400957582_8fo98gqrg",
  "timestamp": "2026-02-18T07:49:17.582Z",
  "type": "notification-answered",
  "notificationId": "notif_1771400770968_zrwbwror9",
  "title": "iMessage Monitoring - Alternative Solutions Plan",
  "message": "**GOAL:** Find a more efficient solution to monitor iMessage instead of a cron job\n**Priority:** Medium\n**Goal ID:** goal_1771393630792_4k48eeuob\n\n---\n\n## PROBLEM STATEMENT\n\nCurrent approach: Cron job runs every 5 minutes polling for new iMessages\n\n**Issues:**\n- CPU overhead from polling every 5 minutes\n- Latency: new messages delayed up to 5 minutes\n- Resource inefficiency: constant wake-ups even when no new messages\n- Cost: Repeated executions of same logic\n\n**Goal:** Replace polling with event-driven architecture or more efficient monitoring\n\n---\n\n## PHASE 1: Research & Options Analysis (Estimated: 1 hour)\n\n**Objectives:** Evaluate all iMessage monitoring approaches\n\n**Investigation Tasks:**\n- [ ] Review current cron job implementation (iMessage Responder at every 5 min)\n- [ ] Check if macOS notifications can trigger alerts (FSEvents API, UNUserNotificationCenter)\n- [ ] Investigate imsg CLI capabilities (does it support watch mode?)\n- [ ] Research socket/webhook approaches (can iMessage send events?)\n- [ ] Evaluate Shortcuts automation (macOS native automation)\n- [ ] Check if OpenClaw has native iMessage event support\n\n**Comparison Matrix:**\n| Approach | Latency | CPU Cost | Complexity | Reliability |\n|----------|---------|----------|------------|-------------|\n| Polling (current) | 5min delay | Medium | Low | High |\n| FSEvents watcher | Real-time | Low | Medium | Medium |\n| Shortcuts automation | Real-time | Low | Medium | Medium |\n| imsg watch mode | Real-time | Low | Low | Unknown |\n| Native macOS hooks | Real-time | Very Low | High | Medium |\n| Webhook listener | Real-time | Very Low | Medium | High |\n\n**Deliverable:** Ranked list of 2-3 viable solutions with pros/cons\n\n---\n\n## PHASE 2: Proof of Concept (Estimated: 2-3 hours)\n\n**Objectives:** Test the most promising alternative\n\n**Tasks:**\n- [ ] If imsg watch mode exists: Test it as replacement for cron\n- [ ] If FSEvents approach: Build file watcher using Node.js fs.watch() or similar\n- [ ] If Shortcuts: Create automation rule to trigger webhook on new iMessage\n- [ ] Test for false positives (trigger too often?)\n- [ ] Measure latency improvement vs current polling\n- [ ] Verify no resource spike\n\n**Success Criteria:**\n- New iMessage detected within 1 second (vs 5 min)\n- CPU usage < 5% during idle\n- No false triggers\n\n---\n\n## PHASE 3: Integration with OpenClaw (Estimated: 1-2 hours)\n\n**Objectives:** Wire new approach into existing system\n\n**Tasks:**\n- [ ] Replace cron job with event-driven listener (if PoC successful)\n- [ ] If webhook approach: Create endpoint to receive iMessage events\n- [ ] Update iMessage response logic (should be identical, just triggered differently)\n- [ ] Disable old cron job (iMessage Responder)\n- [ ] Add logging to track new approach effectiveness\n\n**No Breaking Changes:** Response logic stays the same, just triggered faster\n\n---\n\n## PHASE 4: Testing & Validation (Estimated: 1 hour)\n\n**Objectives:** Verify new approach works reliably\n\n**Tests:**\n- [ ] Send test iMessage from another device\n- [ ] Verify response arrives within 1 second\n- [ ] Monitor for 24 hours: any missed messages?\n- [ ] Check CPU/memory usage (should be lower than polling)\n- [ ] Verify both direct messages and group chats work\n- [ ] Test edge cases (very long messages, images, etc.)\n\n---\n\n## PHASE 5: Optimization & Documentation (Estimated: 1 hour)\n\n**Objectives:** Polish and document solution\n\n**Tasks:**\n- [ ] Fine-tune polling interval if hybrid approach (e.g., 10-30 min instead of 5 min)\n- [ ] Add alerting if watcher stops working\n- [ ] Document setup in TOOLS.md\n- [ ] Create backup plan (if watcher fails, fall back to slower polling)\n- [ ] Update cron cleanup log\n\n---\n\n## ESTIMATED EFFORT & COST\n\n**Time Breakdown:**\n- Research & analysis: 1 hour\n- PoC development: 2-3 hours\n- Integration: 1-2 hours\n- Testing: 1 hour\n- Documentation: 1 hour\n- TOTAL: 6-8 hours (can be spread over several days)\n\n**Cost:**\n- If using LOCAL model: $0\n- If using Sonnet for architecture: ~$0.30\n- Total: $0-0.30\n\n---\n\n## POTENTIAL BLOCKERS\n\n1. **imsg CLI limitations** - If imsg doesn't support real-time events, PoC becomes harder\n   - Mitigation: Use FSEvents or Shortcuts as fallback\n\n2. **macOS-specific approach** - Solution must run on Mac mini\n   - Mitigation: Ensure OpenClaw can trigger callbacks from native macOS events\n\n3. **False triggers** - If watcher is too aggressive, could spam responses\n   - Mitigation: Add deduplication (track last responded message ID)\n\n---\n\n## RECOMMENDED TIMELINE\n\n**Optimal approach:** Phase 1 research -> Phase 2 PoC (commit within 2-3 days) -> Phase 3-5 rollout\n\n**Urgency:** Medium (current system works, but inefficient)\n\n**Good time to start:** Next 1-2 hours (while other tasks are running)\n\n---\n\n## NEXT STEP\n\nApprove plan or provide feedback:\n- Should I start Phase 1 research immediately?\n- Any approaches you want me to prioritize or skip?\n- Any constraints (e.g., must use imsg CLI, no native hooks)?\n\n**Plan created:** 2026-02-18 03:45 AST\n**Status:** Ready for approval\n**Blocking:** No major blockers identified yet",
  "userAnswer": "Go ahead with Phase 1, the goal is to keep token count low.  Reduce the load on the CPU, have as close as possible to real time.  Think outside the box and if a coding solution can be an improvement it's not an issue.",
  "answeredAt": "2026-02-18T07:49:17.581Z"
}