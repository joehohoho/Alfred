# 2026-02-06 - Alfred Dashboard Setup

## Project: Alfred Dashboard
**Location:** `/Users/hopenclaw/.openclaw/workspace/Alfred-Dashboard`  
**GitHub:** https://github.com/joehohoho/Alfred-Dashboard  
**Live:** https://alfred-dashboard-pi.vercel.app

### What It Is
Next.js dashboard for monitoring OpenClaw AI usage and costs. Displays:
- Budget remaining ($25 prepaid credits)
- Daily/weekly/total costs
- Model breakdown (Opus, Sonnet, Haiku, Local)
- Token usage per model

### Tech Stack
- **Frontend:** Next.js 14 (React + TypeScript)
- **Auth:** NextAuth.js + Google OAuth (joe55ho@gmail.com only)
- **Storage:** Upstash Redis (free tier, key-value store)
- **Deployment:** Vercel (auto-deploy from GitHub)
- **Sync:** Bash script runs every 30 min via launchd

### Architecture
```
OpenClaw Mac stats → sync-data.sh (every 30 min)
                          ↓
                   Upstash Redis ←→ Vercel Dashboard
                          ↓
                   GitHub (backup)
```

### Key Files
- **PROJECT.md** - Comprehensive documentation (read this first!)
- **REDIS-SETUP.md** - How to get Upstash credentials
- **sync-data.sh** - Pushes stats to Redis + GitHub
- **app/api/budget/route.ts** - Budget editing API
- **app/api/stats/route.ts** - Stats fetching API

### Important Notes
1. **Database:** Uses Upstash Redis (KV store), NOT Neon Postgres
   - Neon DB (`alfred-stats-db`) is connected but unused — can be deleted
   - Redis stores a single JSON object under key: `stats`
2. **Budget editing:** Works via Redis (Vercel filesystem is read-only)
3. **No token usage:** Dashboard is pure data display — no AI calls
4. **Git commits:** Always use `joesubsho@gmail.com` as author

### Setup Status
✅ Database created (upstash-kv-emerald-lamp)  
✅ Code updated to use Upstash Redis  
⏳ Needs: Redis credentials added to `.env.local`  
⏳ Needs: Run `./sync-data.sh` for initial data  
⏳ Needs: `npm install` for new dependencies  

### Next Steps (When Resuming)
1. Follow `REDIS-SETUP.md` to get credentials from Vercel
2. Add to `.env.local`
3. Run sync script to populate Redis
4. Test budget editing on live site

### Troubleshooting
- **Budget edit fails:** Redis not configured (check env vars)
- **Stats empty:** Run `./sync-data.sh` to populate
- **Deployment fails:** Wrong git author (use joesubsho@gmail.com)

### Documentation
All details in **PROJECT.md** — 300+ lines covering:
- Full architecture diagram
- Environment variables
- File structure
- Sync mechanism
- Common issues
- Quick reference commands

**Always read PROJECT.md first when working on this dashboard.**

---

## Work Done Today
1. Fixed TypeScript error in dashboard (null stats check)
2. Set up Vercel Storage (Upstash Redis)
3. Migrated from deprecated Vercel KV to Upstash Redis
4. Created comprehensive PROJECT.md documentation
5. Updated all code to use Upstash SDK
6. Pushed changes to GitHub (auto-deployed to Vercel)

## Blockers
- Need to add Redis credentials locally before testing
- Budget editing won't work until Redis is populated with initial data

## Cost Impact
- Zero — everything on free tiers
- Upstash Redis: 10k commands/day (using ~200/day)
- Vercel: Free Hobby plan
